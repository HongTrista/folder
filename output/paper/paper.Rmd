---
title: The Poll Engagement has Increased but Sharply Declined in 2019.
author: "Hong Pan"
date: "`r format(Sys.time(), '%d %B %Y')`"

abstract: The line chart and the table created help illustrate that the poll response rate has started to decline in 2019. Declining poll response rates may cause non-response bias, which misunderstanding the real feeling and thinking of people. Two bar charts created help show largest people have a question about Front Yard Parking. Let the government know where people are dissatisfied with the city.
thanks: 'Code and data are available at: https://github.com/HongTrista/folder.'
bibliography: references.bib

output:
  bookdown::pdf_document2:
  toc: no
  fig_cap: yes
  keep_tex: yes
  includes:
    in_header:my_header.tex

header-includes:
 - \usepackage{float}
 - \floatplacement{figure}{H}
 - \floatplacement{table}{H}

 
 
---

```{r setup, include=FALSE}
#install all packages 
knitr::opts_chunk$set(echo = TRUE, fig.pos= "h")
chooseCRANmirror(graphics=FALSE, ind=1)


install.packages("ggplot2") # for drawing nice figures
library(ggplot2)

install.packages("tidyverse") # for filtering data
library(tidyverse)

install.packages("readr") # for read the dataset
library(readr)

install.packages("bookdown") # for cross referencing figures and tables
library(bookdown)

```


# Introduction

Low poll engagement may cause non-response bias, which would misunderstanding the real feeling and thinking of people.[@Cite_Surveys] Public polls belong to human research surveys to help us know how a population thinks about any specific topic. The trained interviewers will ask questions to people chosen randomly from the population being measured. The interviewees' answers will be interpreted and help to make a final decision on the application applied.[@Cite_Wikipedia] The main benefit for people from the public polls is that it gives regular people a chance to be heard instead of letting only media stars speak on behalf of all.[@Cite_gallup]


# need to edit
After knowing the definition and importance of public polls, I want to look at how people's positively toward public polls by creating a variable called engagement rate in this paper. I construct a line chart to show the average engagement rate changes from 2015 to 2020. The graph shows that the engagement rate slightly rises from 2015 to 2019, but a sharp decrease from 2019 to 2020. Then, I create a table to illustrate the average engagement rate for each type of application,  and I find that Permit Parking has the highest average engagement rate. To know more information in detail, I draw two histograms to display how many applicants for each type and the number of results, whether the application has passed. The graphs show that most people have a problem with Front Yard Parking, but it has the highest pass rate.

The remainder of the paper is structured as follows: Section 2 discusses the variables in the data set, Section 3 presents the figures and tables with their explanations,and finally Section 4 provides all the references.


# Data

The analysis for this paper done using R [@Cite_R]and several packages, which listed as followed: 'ggplot2' helps to visualize the data in figures[Cite_ggplot2], 'tidyverse' used for data manipulation[@Cite_tidyverse], 'readr' used for import data set from URL by R[@Cite_readr], and 'bookdown' used for cross-referencing figures and tables[@Cite_bookdown.  The data set, Polls Conducted by the City, I used for analysis in the paper is from the City of Toronto Open Data Portal, which is free to the public and start to collect the data from April 1, 2015.[@Cite_Dataset] 

```{r,include=FALSE}
#Import cleaned dataset
clean_data<-read_csv(url("https://raw.githubusercontent.com/HongTrista/folder/main/input/clean_data.csv"))

#Create a new column, engagement rate.
clean_data<-clean_data%>%
  mutate(Engagement_rate=round((Real_total_number/Potential_total_number),3))
```
From the description of the dataset, we know that the data in the dataset will be updated upon the closing and certification of each poll. The data set after cleaning contains 6 variables with around 1000 conversations and no missing values. The explanations of each variable will be shown in the following:
    - Application_topic: Type of each application, which is a categorical variable.
    - Response_rate_met: Whether the number of ballots returned has met the required response rate, a categorical variable with values 'YES' and 'NO.'
    - Real_total_number: The number of total voters on the final poll list, which is a numerical variable.
    - Potential_total_number: The number of people residing within the poll boundary range, which is a numerical variable.
    - Date: The date the poll has been closed, which is a time categorical variable.
    - Final_result: The final result of the poll, which is a categorical variable with levels of "In favour', ' opposed,' and ' response rate not met.'

The time range for the data in the dataset is from 2015 to 2020 last day. To know how people's attitudes towards the public polls, I draw a line chart to show the engagement rate trend, which is how many people actually responded to the polls. Because according to each application, there will be a list of people selected to participate in the public polls, but some people will choose not to participate for personal reasons. I want to indirectly understand people's attitudes towards the public polls by knowing the engagement rate.


The line chart (Figure \@ref(fig:Figure1)) shows that the engagement rate generally fluctuated between 0.79 to 0.85 from 2015 to 2020. The relatively high engagement rate shows that people actively participated in the public polls in the past six years. We can also see that the figure shows that the average engagement rate from 2017 to 2019 has shown a clear upward trend, but there has been a turning point in 2019. After 2019, the graph shows a sharp downward trend. I speculate that the main reason for the sharp decline may not be a sudden change in people's attitudes, but the covid-19 has reduced the average engagement rate. Specific reasons require more information and data.

```{r Figure1,fig.cap="Average engagement rate in each year",echo=FALSE,fig.height = 3, fig.width = 8}

#create a new column, Date_year, which only includes the value of the year.
new_data$Date_year<-format(new_data$Date,format("%Y"))

# Create a new table helped for drawing the line chart. The table is about the average engagement rate for each year.
table_tmp<-new_data%>%
  group_by(Date_year)%>%
  summarize(
    Mean=round(mean(Engagement_rate),3),)

#Draw the line chart

ggplot(data=table_tmp,aes(x=Date_year,y=Mean,group=1))+
  geom_line(color='red')+
  geom_point()+
  ggtitle('The average engagement rate from 2015 to 2020')+
  ylab('Average engagement rate')+
  xlab('Year')


```


To know more in detail,the table (Table \@ref(tab:table1)) shown below illustrates the average engagement rate for each type of application. The table displays that Parking Permit has the highest average engagement rate, which means when people received the public polls about Parking Permit, most people would choose to participate. Business Improvement Area has the lowest average engagement rate, representing that most people are not interested in this topic.

```{r table1,echo=FALSE}
#Create a table to show the mean average engagement rate and sd for each type of application.
table1<-new_data%>%
  group_by(Type)%>%
  summarize(
    Average_engagement_rate=round(mean(Engagement_rate),3),
    Std_dev=round(sd(Engagement_rate),3)
  )%>%
  arrange(desc(Average_engagement_rate))%>%
  rename(Type_of_application=Type)

#To add a tital for the table
table1 %>% 
  knitr::kable(caption = "The average engagment rate for each type of application")

```

In addition to being interested in the participation rate, I am also interested in which topic people are dissatisfied with the current situation and submitted applications. From the bar chart (Figure \@ref(fig:figure2)), We can see that the number of applications for Front Yard Parking is the most among all application categories. We can speculate that more people have more objections to the current rules for parking in the front yard. 


```{r figure2,fig.cap="The total number of applications of each type",fig.height = 3, fig.width = 8,echo=FALSE}
# Draw bar chart to show total number of application for each type of topic
ggplot(new_data,aes(x=Type,fill=Type))+
  geom_bar(aes(y=..count..))+
  theme(axis.text.x = element_text(angle = 90))+
  coord_flip()


```


Figure  (Figure \@ref(fig:figure3)) shows detailed information about the results of each application. The histogram shows how many applications were finally approved by the City. If the result is positive, the application is marked as "Yes"; otherwise, it is marked as No. In the figure, we can obviously see that Traffic Calming has the largest proportion of No among all types of applications, around 50%. The second type with a high fail rate is Boulevard Cafe, around 30%. For the Front Yard Parking, which is the most popular application type among all types, we can see the pass rate for this type is the highest.


```{r figure3,fig.cap="Type of Application with final result",echo=FALSE}
#Draw a bar chart to show the total result of each type of topic.
ggplot(new_data, aes(Type, fill =Result)) + 
  geom_bar()+
  theme(axis.text.x = element_text(angle = 90))

```

























